drop table samplelinen;

create table samplelinen
(
Subcategory  varchar2(200),
ItemName	varchar2(200),
Price	number,
Cost	number,
color varchar2(20),
linensize varchar2(20),
itemno  varchar2(20),
wholesaleprice varchar2(100)
);

REM INSERTING into SAMPLELINEN
SET DEFINE OFF;
Insert into SAMPLELINEN (SUBCATEGORY,ITEMNAME,PRICE,COST,COLOR,LINENSIZE,ITEMNO,WHOLESALEPRICE) values ('PERDIDO','Aqua Perdido 108RD',56.314440000000005,40.5,'AQUA','108RD','BL061827','45.0');
Insert into SAMPLELINEN (SUBCATEGORY,ITEMNAME,PRICE,COST,COLOR,LINENSIZE,ITEMNO,WHOLESALEPRICE) values ('PERDIDO','Aqua Perdido 108X156',93.85740000000001,67.5,'AQUA','108X156','BL061623','75.0');
Insert into SAMPLELINEN (SUBCATEGORY,ITEMNAME,PRICE,COST,COLOR,LINENSIZE,ITEMNO,WHOLESALEPRICE) values ('PERDIDO','Aqua Perdido 120RD',68.82876,49.5,'AQUA','120RD','BL061229','55.0');
Insert into SAMPLELINEN (SUBCATEGORY,ITEMNAME,PRICE,COST,COLOR,LINENSIZE,ITEMNO,WHOLESALEPRICE) values ('PERDIDO','Aqua Perdido 132RD',81.34308000000001,58.5,'AQUA','132RD','BL061329','65.0');
Insert into SAMPLELINEN (SUBCATEGORY,ITEMNAME,PRICE,COST,COLOR,LINENSIZE,ITEMNO,WHOLESALEPRICE) values ('PERDIDO','Aqua Perdido 90X156',81.34308000000001,58.5,'AQUA','90X156','BL069523','65.0');
Insert into SAMPLELINEN (SUBCATEGORY,ITEMNAME,PRICE,COST,COLOR,LINENSIZE,ITEMNO,WHOLESALEPRICE) values ('PERDIDO','Aqua Perdido Runner',25.028640000000003,18,'AQUA','RUNNER','BL06RU23','20.0');
Insert into SAMPLELINEN (SUBCATEGORY,ITEMNAME,PRICE,COST,COLOR,LINENSIZE,ITEMNO,WHOLESALEPRICE) values ('PERDIDO','Aqua Perdido/Ivory Napkin',4.004582400000001,2.8800000000000003,'AQUA','NAPKIN','BL06NP24','3.2');
Insert into SAMPLELINEN (SUBCATEGORY,ITEMNAME,PRICE,COST,COLOR,LINENSIZE,ITEMNO,WHOLESALEPRICE) values ('NAVARRE','Coral Navarre 108RD',68.82876,49.5,'CORAL','108RD','OR061813','55.0');
Insert into SAMPLELINEN (SUBCATEGORY,ITEMNAME,PRICE,COST,COLOR,LINENSIZE,ITEMNO,WHOLESALEPRICE) values ('NAVARRE','Coral Navarre 108X156',93.85740000000001,67.5,'CORAL','108X156','OR061614','75.0');
Insert into SAMPLELINEN (SUBCATEGORY,ITEMNAME,PRICE,COST,COLOR,LINENSIZE,ITEMNO,WHOLESALEPRICE) values ('NAVARRE','Coral Navarre 120RD',75.08592000000002,54,'CORAL','120RD','OR061213','60.0');
Insert into SAMPLELINEN (SUBCATEGORY,ITEMNAME,PRICE,COST,COLOR,LINENSIZE,ITEMNO,WHOLESALEPRICE) values ('NAVARRE','Coral Navarre 132RD',81.34308000000001,58.5,'CORAL','132RD','OR061313','65.0');
Insert into SAMPLELINEN (SUBCATEGORY,ITEMNAME,PRICE,COST,COLOR,LINENSIZE,ITEMNO,WHOLESALEPRICE) values ('NAVARRE','Coral Navarre 90X156',81.34308000000001,58.5,'CORAL','90X156','OR069513','65.0');
Insert into SAMPLELINEN (SUBCATEGORY,ITEMNAME,PRICE,COST,COLOR,LINENSIZE,ITEMNO,WHOLESALEPRICE) values ('NAVARRE','Coral Navarre Runner',25.028640000000003,18,'CORAL','RUNNER','OR06RU13','20.0');
Insert into SAMPLELINEN (SUBCATEGORY,ITEMNAME,PRICE,COST,COLOR,LINENSIZE,ITEMNO,WHOLESALEPRICE) values ('SEASIDE','Gulf Seaside 108RD',56.314440000000005,40.5,'GULF','108RD','BL061826','45.0');
Insert into SAMPLELINEN (SUBCATEGORY,ITEMNAME,PRICE,COST,COLOR,LINENSIZE,ITEMNO,WHOLESALEPRICE) values ('SEASIDE','Gulf Seaside 108X156',93.85740000000001,67.5,'GULF','108X156','BL061622','75.0');
Insert into SAMPLELINEN (SUBCATEGORY,ITEMNAME,PRICE,COST,COLOR,LINENSIZE,ITEMNO,WHOLESALEPRICE) values ('SEASIDE','Gulf Seaside 120RD',68.82876,49.5,'GULF','120RD','BL061228','55.0');
Insert into SAMPLELINEN (SUBCATEGORY,ITEMNAME,PRICE,COST,COLOR,LINENSIZE,ITEMNO,WHOLESALEPRICE) values ('SEASIDE','Gulf Seaside 132RD',81.34308000000001,58.5,'GULF','132RD','BL061328','65.0');
Insert into SAMPLELINEN (SUBCATEGORY,ITEMNAME,PRICE,COST,COLOR,LINENSIZE,ITEMNO,WHOLESALEPRICE) values ('SEASIDE','Gulf Seaside 90X156',81.34308000000001,58.5,'GULF','90X156','BL069522','65.0');
Insert into SAMPLELINEN (SUBCATEGORY,ITEMNAME,PRICE,COST,COLOR,LINENSIZE,ITEMNO,WHOLESALEPRICE) values ('SEASIDE','Gulf Seaside Runner',25.028640000000003,18,'GULF','RUNNER','BL06RU22','20.0');
Insert into SAMPLELINEN (SUBCATEGORY,ITEMNAME,PRICE,COST,COLOR,LINENSIZE,ITEMNO,WHOLESALEPRICE) values ('SEASIDE','Gulf Seaside/Ivory Napkin',4.004582400000001,2.8800000000000003,'GULF','NAPKIN','BL06NP23','3.2');
Insert into SAMPLELINEN (SUBCATEGORY,ITEMNAME,PRICE,COST,COLOR,LINENSIZE,ITEMNO,WHOLESALEPRICE) values ('NAVARRE','Laguna Navarre 108RD',68.82876,49.5,'LAGUNA','108RD','BL061825','55.0');
Insert into SAMPLELINEN (SUBCATEGORY,ITEMNAME,PRICE,COST,COLOR,LINENSIZE,ITEMNO,WHOLESALEPRICE) values ('NAVARRE','Laguna Navarre 108X156',93.85740000000001,67.5,'LAGUNA','108X156','BL061621','75.0');
Insert into SAMPLELINEN (SUBCATEGORY,ITEMNAME,PRICE,COST,COLOR,LINENSIZE,ITEMNO,WHOLESALEPRICE) values ('NAVARRE','Laguna Navarre 120RD',75.08592000000002,54,'LAGUNA','120RD','BL061227','60.0');
Insert into SAMPLELINEN (SUBCATEGORY,ITEMNAME,PRICE,COST,COLOR,LINENSIZE,ITEMNO,WHOLESALEPRICE) values ('NAVARRE','Laguna Navarre 132RD',81.34308000000001,58.5,'LAGUNA','132RD','BL061327','65.0');
Insert into SAMPLELINEN (SUBCATEGORY,ITEMNAME,PRICE,COST,COLOR,LINENSIZE,ITEMNO,WHOLESALEPRICE) values ('NAVARRE','Laguna Navarre 90X156',81.34308000000001,58.5,'LAGUNA','90X156','BL069521','65.0');
Insert into SAMPLELINEN (SUBCATEGORY,ITEMNAME,PRICE,COST,COLOR,LINENSIZE,ITEMNO,WHOLESALEPRICE) values ('NAVARRE','Laguna Navarre Runner',25.028640000000003,18,'LAGUNA','RUNNER','BL06RU21','20.0');
Insert into SAMPLELINEN (SUBCATEGORY,ITEMNAME,PRICE,COST,COLOR,LINENSIZE,ITEMNO,WHOLESALEPRICE) values ('PERDIDO','Papaya Perdido 108RD',56.314440000000005,40.5,'PAPAYA ','108RD','OR061817','45.0');
Insert into SAMPLELINEN (SUBCATEGORY,ITEMNAME,PRICE,COST,COLOR,LINENSIZE,ITEMNO,WHOLESALEPRICE) values ('PERDIDO','Papaya Perdido 108X156',93.85740000000001,67.5,'PAPAYA ','108X156','OR061618','75.0');
Insert into SAMPLELINEN (SUBCATEGORY,ITEMNAME,PRICE,COST,COLOR,LINENSIZE,ITEMNO,WHOLESALEPRICE) values ('PERDIDO','Papaya Perdido 120RD',68.82876,49.5,'PAPAYA ','120RD','OR061217','55.0');
Insert into SAMPLELINEN (SUBCATEGORY,ITEMNAME,PRICE,COST,COLOR,LINENSIZE,ITEMNO,WHOLESALEPRICE) values ('PERDIDO','Papaya Perdido 132RD',81.34308000000001,58.5,'PAPAYA ','132RD','OR061317','65.0');
Insert into SAMPLELINEN (SUBCATEGORY,ITEMNAME,PRICE,COST,COLOR,LINENSIZE,ITEMNO,WHOLESALEPRICE) values ('PERDIDO','Papaya Perdido 90X156',81.34308000000001,58.5,'PAPAYA ','90X156','OR069517','65.0');
Insert into SAMPLELINEN (SUBCATEGORY,ITEMNAME,PRICE,COST,COLOR,LINENSIZE,ITEMNO,WHOLESALEPRICE) values ('PERDIDO','Papaya Perdido Runner',25.028640000000003,18,'PAPAYA ','RUNNER','OR06RU17','20.0');
Insert into SAMPLELINEN (SUBCATEGORY,ITEMNAME,PRICE,COST,COLOR,LINENSIZE,ITEMNO,WHOLESALEPRICE) values ('PERDIDO','Papaya Perdido/Ivory Napkin',4.004582400000001,2.8800000000000003,'PAPAYA ','NAPKIN','OR06NP15','3.2');
Insert into SAMPLELINEN (SUBCATEGORY,ITEMNAME,PRICE,COST,COLOR,LINENSIZE,ITEMNO,WHOLESALEPRICE) values ('SANTA ROSA','Santa Rosa 108RD',56.314440000000005,40.5,'ORANGE','108RD','OR061816','45.0');
Insert into SAMPLELINEN (SUBCATEGORY,ITEMNAME,PRICE,COST,COLOR,LINENSIZE,ITEMNO,WHOLESALEPRICE) values ('SANTA ROSA','Santa Rosa 108X156',93.85740000000001,67.5,'ORANGE','108X156','OR061617','75.0');
Insert into SAMPLELINEN (SUBCATEGORY,ITEMNAME,PRICE,COST,COLOR,LINENSIZE,ITEMNO,WHOLESALEPRICE) values ('SANTA ROSA','Santa Rosa 120RD',68.82876,49.5,'ORANGE','120RD','OR061216','55.0');
Insert into SAMPLELINEN (SUBCATEGORY,ITEMNAME,PRICE,COST,COLOR,LINENSIZE,ITEMNO,WHOLESALEPRICE) values ('SANTA ROSA','Santa Rosa 132RD',81.34308000000001,58.5,'ORANGE','132RD','OR061316','65.0');
Insert into SAMPLELINEN (SUBCATEGORY,ITEMNAME,PRICE,COST,COLOR,LINENSIZE,ITEMNO,WHOLESALEPRICE) values ('SANTA ROSA','Santa Rosa 90X156',81.34308000000001,58.5,'ORANGE','90X156','OR069516','65.0');
Insert into SAMPLELINEN (SUBCATEGORY,ITEMNAME,PRICE,COST,COLOR,LINENSIZE,ITEMNO,WHOLESALEPRICE) values ('SANTA ROSA','Santa Rosa Napkin',4.004582400000001,2.8800000000000003,'ORANGE','NAPKIN','OR06NP14','3.2');
Insert into SAMPLELINEN (SUBCATEGORY,ITEMNAME,PRICE,COST,COLOR,LINENSIZE,ITEMNO,WHOLESALEPRICE) values ('SANTA ROSA','Santa Rosa Runner',25.028640000000003,18,'ORANGE','RUNNER','OR06RU16','20.0');
Insert into SAMPLELINEN (SUBCATEGORY,ITEMNAME,PRICE,COST,COLOR,LINENSIZE,ITEMNO,WHOLESALEPRICE) values ('SEASIDE ','Sunset Seaside 108RD',56.314440000000005,40.5,'SUNSET','108RD','OR061815','45.0');
Insert into SAMPLELINEN (SUBCATEGORY,ITEMNAME,PRICE,COST,COLOR,LINENSIZE,ITEMNO,WHOLESALEPRICE) values ('SEASIDE ','Sunset Seaside 108X156',93.85740000000001,67.5,'SUNSET','108X156','OR061616','75.0');
Insert into SAMPLELINEN (SUBCATEGORY,ITEMNAME,PRICE,COST,COLOR,LINENSIZE,ITEMNO,WHOLESALEPRICE) values ('SEASIDE ','Sunset Seaside 120RD',68.82876,49.5,'SUNSET','120RD','OR061215','55.0');
Insert into SAMPLELINEN (SUBCATEGORY,ITEMNAME,PRICE,COST,COLOR,LINENSIZE,ITEMNO,WHOLESALEPRICE) values ('SEASIDE ','Sunset Seaside 132RD',81.34308000000001,58.5,'SUNSET','132RD','OR061315','65.0');
Insert into SAMPLELINEN (SUBCATEGORY,ITEMNAME,PRICE,COST,COLOR,LINENSIZE,ITEMNO,WHOLESALEPRICE) values ('SEASIDE ','Sunset Seaside 90X156',81.34308000000001,58.5,'SUNSET','90X156','OR069515','65.0');
Insert into SAMPLELINEN (SUBCATEGORY,ITEMNAME,PRICE,COST,COLOR,LINENSIZE,ITEMNO,WHOLESALEPRICE) values ('SEASIDE ','Sunset Seaside Runner',25.028640000000003,18,'SUNSET','RUNNER','OR06RU15','20.0');
Insert into SAMPLELINEN (SUBCATEGORY,ITEMNAME,PRICE,COST,COLOR,LINENSIZE,ITEMNO,WHOLESALEPRICE) values ('SEASIDE ','Sunset Seaside/Ivory Napkin',4.004582400000001,2.8800000000000003,'SUNSET','NAPKIN','OR06NP13','3.2');
Commit;

alter table samplelinen drop column wholesaleprice;

declare
    lcat        number;
    lsub        number;
    lLinencolor number;
    lLinenSize  number;
begin
    for data in(Select * from samplelinen)
    loop
        begin 
        --inserting sub category as category as category not provided 
            select id into lcat
            from linencategory
            where upper(trim(category)) = upper(trim(data.Subcategory));
        exception
            when no_data_found then
            insert into linencategory(id,active,category)values(linencategory_pk_seq.nextval,1,trim(data.Subcategory)) returning id into lcat;
        end;
        begin 
            select id into lsub
            from linensubcategory
            where linencategory_id = lcat 
            and  upper(trim(subcategory)) = upper(trim(data.subcategory));
        exception
            when no_data_found then
            insert into linensubcategory(id,active,subcategory,linencategory_id)values(linensubcategory_pk_seq.nextval,1,trim(data.subcategory),lcat);
            select linensubcategory_pk_seq.currval into lsub from dual;
        end;
        Begin
            select id into lLinenSize from linensize where upper(name)=upper(data.linensize);
        Exception
            when no_data_found then
            insert into linensize(id,active,name) values(LINENSIZE_PK_SEQ.NEXTVAL,1,data.linensize) returning id into lLinenSize;
        end;
        Begin
            select id into lLinencolor from linencolor where upper(name)=upper(data.color);
        Exception
            when no_data_found then
           insert into linencolor(id,active,name) values(LINENCOLOR_PK_SEQ.NEXTVAL,1,data.color) returning id into lLinencolor;
        end;
        
        insert into linen (id,name,linensize_id, linencolor_id,cost,ourcost,linensubcategory_id,active)
        values ( linen_pk_seq.nextval, data.itemname||' - '||data.itemno, lLinenSize, lLinencolor,round(data.price,2), data.cost,lsub,1 );
    end loop;
    commit;
end;
/

