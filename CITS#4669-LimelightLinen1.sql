drop table samplelinen;

create table samplelinen
(
Category  varchar2(200),
Subcategory  varchar2(200),
ItemName	varchar2(200),
Price	number,
Cost	number,
color varchar2(20),
linensize varchar2(20),
itemno  varchar2(20),
wholesaleprice varchar2(100)
);

--Dropping column as it is not needed.
alter table samplelinen drop column wholesaleprice;

REM INSERTING into SAMPLELINEN
SET DEFINE OFF;
Insert into SAMPLELINEN (CATEGORY,SUBCATEGORY,ITEMNAME,PRICE,COST,COLOR,LINENSIZE,ITEMNO) values ('ANGUILLA','ANGUILLA','Noir Anguilla 108RD',68.82876,49.5,'NOIR','108RD','BK061809');
Insert into SAMPLELINEN (CATEGORY,SUBCATEGORY,ITEMNAME,PRICE,COST,COLOR,LINENSIZE,ITEMNO) values ('ANGUILLA','ANGUILLA','Noir Anguilla 108X156',93.85740000000001,67.5,'NOIR','108X156','BK061609');
Insert into SAMPLELINEN (CATEGORY,SUBCATEGORY,ITEMNAME,PRICE,COST,COLOR,LINENSIZE,ITEMNO) values ('ANGUILLA','ANGUILLA','Noir Anguilla 120RD',75.08592000000002,54,'NOIR','120RD','BK061209');
Insert into SAMPLELINEN (CATEGORY,SUBCATEGORY,ITEMNAME,PRICE,COST,COLOR,LINENSIZE,ITEMNO) values ('ANGUILLA','ANGUILLA','Noir Anguilla 132RD',81.34308000000001,58.5,'NOIR','132RD','BK061309');
Insert into SAMPLELINEN (CATEGORY,SUBCATEGORY,ITEMNAME,PRICE,COST,COLOR,LINENSIZE,ITEMNO) values ('ANGUILLA','ANGUILLA','Noir Anguilla 90X156',81.34308000000001,58.5,'NOIR','90X156','BK069509');
Insert into SAMPLELINEN (CATEGORY,SUBCATEGORY,ITEMNAME,PRICE,COST,COLOR,LINENSIZE,ITEMNO) values ('ANGUILLA','ANGUILLA','Noir Anguilla Runner',25.028640000000003,18,'NOIR','RUNNER','BK06RU09');
Insert into SAMPLELINEN (CATEGORY,SUBCATEGORY,ITEMNAME,PRICE,COST,COLOR,LINENSIZE,ITEMNO) values ('ANGUILLA','ANGUILLA','Noir Anguilla/Ivory Napkin',3.7542960000000005,2.7,'NOIR','NAPKIN','BK06NP07');
Insert into SAMPLELINEN (CATEGORY,SUBCATEGORY,ITEMNAME,PRICE,COST,COLOR,LINENSIZE,ITEMNO) values ('ANGUILLA','ANGUILLA','Sand Anguilla 108RD',68.82876,49.5,'SAND','108RD','BR061810');
Insert into SAMPLELINEN (CATEGORY,SUBCATEGORY,ITEMNAME,PRICE,COST,COLOR,LINENSIZE,ITEMNO) values ('ANGUILLA','ANGUILLA','Sand Anguilla 108X156',93.85740000000001,67.5,'SAND','108X156','BR061610');
Insert into SAMPLELINEN (CATEGORY,SUBCATEGORY,ITEMNAME,PRICE,COST,COLOR,LINENSIZE,ITEMNO) values ('ANGUILLA','ANGUILLA','Sand Anguilla 120RD',75.08592000000002,54,'SAND','120RD','BR061210');
Insert into SAMPLELINEN (CATEGORY,SUBCATEGORY,ITEMNAME,PRICE,COST,COLOR,LINENSIZE,ITEMNO) values ('ANGUILLA','ANGUILLA','Sand Anguilla 132RD',81.34308000000001,58.5,'SAND','132RD','BR061310');
Insert into SAMPLELINEN (CATEGORY,SUBCATEGORY,ITEMNAME,PRICE,COST,COLOR,LINENSIZE,ITEMNO) values ('ANGUILLA','ANGUILLA','Sand Anguilla 90X156',81.34308000000001,58.5,'SAND','90X156','BR069510');
Insert into SAMPLELINEN (CATEGORY,SUBCATEGORY,ITEMNAME,PRICE,COST,COLOR,LINENSIZE,ITEMNO) values ('ANGUILLA','ANGUILLA','Sand Anguilla Runner',25.028640000000003,18,'SAND','RUNNER','BR06RU10');
Insert into SAMPLELINEN (CATEGORY,SUBCATEGORY,ITEMNAME,PRICE,COST,COLOR,LINENSIZE,ITEMNO) values ('ANGUILLA','ANGUILLA','Sand Anguilla/Ivory Napkin',3.7542960000000005,2.7,'SAND','NAPKIN','BR06NP07');
Insert into SAMPLELINEN (CATEGORY,SUBCATEGORY,ITEMNAME,PRICE,COST,COLOR,LINENSIZE,ITEMNO) values ('ELEUTHERA','ELEUTHERA','Noir Eleuthera 108RD',68.82876,49.5,'NOIR','108RD','BK061810');
Insert into SAMPLELINEN (CATEGORY,SUBCATEGORY,ITEMNAME,PRICE,COST,COLOR,LINENSIZE,ITEMNO) values ('ELEUTHERA','ELEUTHERA','Noir Eleuthera 108X156',93.85740000000001,67.5,'NOIR','108X156','BK061610');
Insert into SAMPLELINEN (CATEGORY,SUBCATEGORY,ITEMNAME,PRICE,COST,COLOR,LINENSIZE,ITEMNO) values ('ELEUTHERA','ELEUTHERA','Noir Eleuthera 120RD',75.08592000000002,54,'NOIR','120RD','BK061210');
Insert into SAMPLELINEN (CATEGORY,SUBCATEGORY,ITEMNAME,PRICE,COST,COLOR,LINENSIZE,ITEMNO) values ('ELEUTHERA','ELEUTHERA','Noir Eleuthera 132RD',81.34308000000001,58.5,'NOIR','132RD','BK061310');
Insert into SAMPLELINEN (CATEGORY,SUBCATEGORY,ITEMNAME,PRICE,COST,COLOR,LINENSIZE,ITEMNO) values ('ELEUTHERA','ELEUTHERA','Noir Eleuthera 90X156',81.34308000000001,58.5,'NOIR','90X156','BK069510');
Insert into SAMPLELINEN (CATEGORY,SUBCATEGORY,ITEMNAME,PRICE,COST,COLOR,LINENSIZE,ITEMNO) values ('ELEUTHERA','ELEUTHERA','Noir Eleuthera Runner',25.028640000000003,18,'NOIR','RUNNER','BK06RU10');
Insert into SAMPLELINEN (CATEGORY,SUBCATEGORY,ITEMNAME,PRICE,COST,COLOR,LINENSIZE,ITEMNO) values ('ELEUTHERA','ELEUTHERA','Noir Eleuthera/Ivory Napkin',3.7542960000000005,2.7,'NOIR','NP DBL','BK06NP08');
Insert into SAMPLELINEN (CATEGORY,SUBCATEGORY,ITEMNAME,PRICE,COST,COLOR,LINENSIZE,ITEMNO) values ('ELEUTHERA','ELEUTHERA','Sand Eleuthera 108RD',68.82876,49.5,'SAND','108RD','BR061811');
Insert into SAMPLELINEN (CATEGORY,SUBCATEGORY,ITEMNAME,PRICE,COST,COLOR,LINENSIZE,ITEMNO) values ('ELEUTHERA','ELEUTHERA','Sand Eleuthera 108X156',93.85740000000001,67.5,'SAND','108X156','BR061611');
Insert into SAMPLELINEN (CATEGORY,SUBCATEGORY,ITEMNAME,PRICE,COST,COLOR,LINENSIZE,ITEMNO) values ('ELEUTHERA','ELEUTHERA','Sand Eleuthera 120RD',75.08592000000002,54,'SAND','120RD','BR061211');
Insert into SAMPLELINEN (CATEGORY,SUBCATEGORY,ITEMNAME,PRICE,COST,COLOR,LINENSIZE,ITEMNO) values ('ELEUTHERA','ELEUTHERA','Sand Eleuthera 132RD',81.34308000000001,58.5,'SAND','132RD','BR061311');
Insert into SAMPLELINEN (CATEGORY,SUBCATEGORY,ITEMNAME,PRICE,COST,COLOR,LINENSIZE,ITEMNO) values ('ELEUTHERA','ELEUTHERA','Sand Eleuthera 90X156',81.34308000000001,58.5,'SAND','90X156','BR069511');
Insert into SAMPLELINEN (CATEGORY,SUBCATEGORY,ITEMNAME,PRICE,COST,COLOR,LINENSIZE,ITEMNO) values ('ELEUTHERA','ELEUTHERA','Sand Eleuthera Runner',25.028640000000003,18,'SAND','RUNNER','BR06RU11');
Insert into SAMPLELINEN (CATEGORY,SUBCATEGORY,ITEMNAME,PRICE,COST,COLOR,LINENSIZE,ITEMNO) values ('ELEUTHERA','ELEUTHERA','Sand Eleuthera/Ivory Napkin',3.7542960000000005,2.7,'SAND','NP DBL','BR06NP08');
Insert into SAMPLELINEN (CATEGORY,SUBCATEGORY,ITEMNAME,PRICE,COST,COLOR,LINENSIZE,ITEMNO) values ('HARBOUR ISLAND','HARBOUR ISLAND','Harbour Island 108RD',56.314440000000005,40.5,'CORAL','108RD','OR061814');
Insert into SAMPLELINEN (CATEGORY,SUBCATEGORY,ITEMNAME,PRICE,COST,COLOR,LINENSIZE,ITEMNO) values ('HARBOUR ISLAND','HARBOUR ISLAND','Harbour Island 108X156',81.34308000000001,58.5,'CORAL','108X156','OR061615');
Insert into SAMPLELINEN (CATEGORY,SUBCATEGORY,ITEMNAME,PRICE,COST,COLOR,LINENSIZE,ITEMNO) values ('HARBOUR ISLAND','HARBOUR ISLAND','Harbour Island 120RD',62.571600000000004,45,'CORAL','120RD','OR061214');
Insert into SAMPLELINEN (CATEGORY,SUBCATEGORY,ITEMNAME,PRICE,COST,COLOR,LINENSIZE,ITEMNO) values ('HARBOUR ISLAND','HARBOUR ISLAND','Harbour Island 132RD',68.82876,49.5,'CORAL','132RD','OR061314');
Insert into SAMPLELINEN (CATEGORY,SUBCATEGORY,ITEMNAME,PRICE,COST,COLOR,LINENSIZE,ITEMNO) values ('HARBOUR ISLAND','HARBOUR ISLAND','Harbour Island 90X156',68.82876,49.5,'CORAL','90X156','OR069514');
Insert into SAMPLELINEN (CATEGORY,SUBCATEGORY,ITEMNAME,PRICE,COST,COLOR,LINENSIZE,ITEMNO) values ('HARBOUR ISLAND','HARBOUR ISLAND','Harbour Island Runner',18.771480000000004,13.5,'CORAL','RUNNER','OR06RU14');
Insert into SAMPLELINEN (CATEGORY,SUBCATEGORY,ITEMNAME,PRICE,COST,COLOR,LINENSIZE,ITEMNO) values ('MARTINIQUE','MARTINIQUE','Martinique 108RD',68.82876,49.5,'GREEN','108RD','GR061824');
Insert into SAMPLELINEN (CATEGORY,SUBCATEGORY,ITEMNAME,PRICE,COST,COLOR,LINENSIZE,ITEMNO) values ('MARTINIQUE','MARTINIQUE','Martinique 108X156',93.85740000000001,67.5,'GREEN','108X156','GR061618');
Insert into SAMPLELINEN (CATEGORY,SUBCATEGORY,ITEMNAME,PRICE,COST,COLOR,LINENSIZE,ITEMNO) values ('MARTINIQUE','MARTINIQUE','Martinique 120RD',75.08592000000002,54,'GREEN','120RD','GR061221');
Insert into SAMPLELINEN (CATEGORY,SUBCATEGORY,ITEMNAME,PRICE,COST,COLOR,LINENSIZE,ITEMNO) values ('MARTINIQUE','MARTINIQUE','Martinique 132RD',81.34308000000001,58.5,'GREEN','132RD','GR061319');
Insert into SAMPLELINEN (CATEGORY,SUBCATEGORY,ITEMNAME,PRICE,COST,COLOR,LINENSIZE,ITEMNO) values ('MARTINIQUE','MARTINIQUE','Martinique 90X156',81.34308000000001,58.5,'GREEN','90X156','GR069509');
Insert into SAMPLELINEN (CATEGORY,SUBCATEGORY,ITEMNAME,PRICE,COST,COLOR,LINENSIZE,ITEMNO) values ('MARTINIQUE','MARTINIQUE','Martinique Runner',25.028640000000003,18,'GREEN','RUNNER','GR06RU12');
Insert into SAMPLELINEN (CATEGORY,SUBCATEGORY,ITEMNAME,PRICE,COST,COLOR,LINENSIZE,ITEMNO) values ('MARTINIQUE','MARTINIQUE','Martinique/Ivory Napkin',3.7542960000000005,2.7,'GREEN','NP DBL','GR06NP22');
Insert into SAMPLELINEN (CATEGORY,SUBCATEGORY,ITEMNAME,PRICE,COST,COLOR,LINENSIZE,ITEMNO) values ('SAINT BARTHS','SAINT BARTHS','Saint Barths 108RD',68.82876,49.5,'BLACK','108RD','BK061808');
Insert into SAMPLELINEN (CATEGORY,SUBCATEGORY,ITEMNAME,PRICE,COST,COLOR,LINENSIZE,ITEMNO) values ('SAINT BARTHS','SAINT BARTHS','Saint Barths 108X156',93.85740000000001,67.5,'BLACK','108X156','BK061608');
Insert into SAMPLELINEN (CATEGORY,SUBCATEGORY,ITEMNAME,PRICE,COST,COLOR,LINENSIZE,ITEMNO) values ('SAINT BARTHS','SAINT BARTHS','Saint Barths 120RD',75.08592000000002,54,'BLACK','120RD','BK061208');
Insert into SAMPLELINEN (CATEGORY,SUBCATEGORY,ITEMNAME,PRICE,COST,COLOR,LINENSIZE,ITEMNO) values ('SAINT BARTHS','SAINT BARTHS','Saint Barths 132RD',81.34308000000001,58.5,'BLACK','132RD','BK061308');
Insert into SAMPLELINEN (CATEGORY,SUBCATEGORY,ITEMNAME,PRICE,COST,COLOR,LINENSIZE,ITEMNO) values ('SAINT BARTHS','SAINT BARTHS','Saint Barths 90X156',81.34308000000001,58.5,'BLACK','90X156','BK069508');
Insert into SAMPLELINEN (CATEGORY,SUBCATEGORY,ITEMNAME,PRICE,COST,COLOR,LINENSIZE,ITEMNO) values ('SAINT BARTHS','SAINT BARTHS','Saint Barths Runner',25.028640000000003,18,'BLACK','RUNNER','BK06RU08');

declare
    lcat        number;
    lsub        number;
    lLinencolor number;
    lLinenSize  number;
begin
    for data in(Select * from samplelinen)
    loop
        begin 
            select id into lcat
            from linencategory
            where upper(trim(category)) = upper(trim(data.category));
        exception
            when no_data_found then
            insert into linencategory(id,active,category)values(linencategory_pk_seq.nextval,1,trim(data.category));
            select linencategory_pk_seq.currval into lcat from dual;
        end;
        begin 
            select id into lsub
            from linensubcategory
            where linencategory_id = lcat 
            and  upper(trim(subcategory)) = upper(trim(data.subcategory));
        exception
            when no_data_found then
            insert into linensubcategory(id,active,subcategory,linencategory_id)values(linensubcategory_pk_seq.nextval,1,trim(data.subcategory),lcat);
            select linensubcategory_pk_seq.currval into lsub from dual;
        end;
        Begin
            insert into linensize(id,active,name) values(LINENSIZE_PK_SEQ.NEXTVAL,1,data.linensize) returning id into lLinenSize;
        Exception
            when dup_val_on_index then
            null;
        end;
        Begin
            insert into linencolor(id,active,name) values(LINENCOLOR_PK_SEQ.NEXTVAL,1,data.color) returning id into lLinencolor;
        Exception
            when dup_val_on_index then
            null;
        end;
        
        insert into linen (id,name,linensize_id, linencolor_id,cost,ourcost,linensubcategory_id,active)
        values ( linen_pk_seq.nextval, data.itemname||' - '||data.itemno, lLinenSize, lLinencolor,round(data.price,2), data.cost,lsub,1 );
    end loop;
    commit;
end;
/

